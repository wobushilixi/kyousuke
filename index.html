<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)">
    <title>iozz - æ™ºèƒ½çº¿è·¯ä¼˜é€‰</title>
    <meta name="description" content="iozz æ™ºèƒ½çº¿è·¯æ£€æµ‹ç³»ç»Ÿ">
    
    <script>
        // PWA Service Worker æ³¨å†Œ
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').catch(err => console.log('SW reg fail', err));
            });
        }
    </script>

    <style>
        /* --- æ ¸å¿ƒå˜é‡ & Reset --- */
        :root {
            /* æµ…è‰²æ¨¡å¼å˜é‡ */
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --card-bg: rgba(255, 255, 255, 0.65);
            --card-border: rgba(255, 255, 255, 0.8);
            --card-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.1), 0 0 1px rgba(0,0,0,0.1);
            --text-primary: #1d1d1f;
            --text-secondary: #86868b;
            --accent-color: #007AFF;
            --accent-gradient: linear-gradient(135deg, #007AFF 0%, #00C6FF 100%);
            --danger-color: #FF3B30;
            --success-color: #34C759;
            --warning-color: #FF9500;
            --surface-hover: rgba(0, 0, 0, 0.05);
            --font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                /* æ·±è‰²æ¨¡å¼å˜é‡ */
                --bg-gradient: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
                --card-bg: rgba(30, 41, 59, 0.7);
                --card-border: rgba(255, 255, 255, 0.1);
                --card-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
                --text-primary: #f8fafc;
                --text-secondary: #94a3b8;
                --accent-color: #3b82f6;
                --accent-gradient: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
                --surface-hover: rgba(255, 255, 255, 0.1);
            }
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        
        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-family);
            background: var(--bg-gradient);
            background-attachment: fixed; /* å›ºå®šèƒŒæ™¯ */
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
            transition: color 0.3s, background 0.3s;
        }

        /* èƒŒæ™¯è£…é¥°åŠ¨ç”» */
        .bg-blob {
            position: absolute;
            top: -10%;
            right: -10%;
            width: 50vw;
            height: 50vw;
            background: radial-gradient(circle, rgba(0, 122, 255, 0.15) 0%, rgba(0, 0, 0, 0) 70%);
            border-radius: 50%;
            z-index: 0;
            animation: float 10s infinite ease-in-out;
            pointer-events: none;
        }
        .bg-blob.two {
            top: auto; bottom: -10%; left: -10%;
            background: radial-gradient(circle, rgba(52, 199, 89, 0.1) 0%, rgba(0, 0, 0, 0) 70%);
            animation-delay: -5s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(20px, 30px); }
        }

        /* --- å¸ƒå±€å®¹å™¨ --- */
        .container {
            position: relative;
            z-index: 10;
            width: 100%;
            max-width: 420px;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        /* --- å¤´éƒ¨åŒºåŸŸ --- */
        .header {
            text-align: center;
            margin-bottom: 10px;
            animation: fadeInDown 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .logo-box {
            width: 96px;
            height: 96px;
            border-radius: 26px;
            margin: 0 auto 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            position: relative;
            background: #fff;
            transition: transform 0.3s ease;
        }
        
        .logo-box:hover { transform: scale(1.02); }

        .logo-box img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            border-radius: 26px; 
            will-change: transform;
        }

        /* çŠ¶æ€å‘¼å¸ç¯ï¼ˆç”¨äºLogoå³ä¸‹è§’ï¼‰ */
        .status-dot {
            position: absolute;
            bottom: -5px;
            right: -5px;
            width: 24px;
            height: 24px;
            background: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 2;
        }
        
        .dot-inner {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--text-secondary); /* åˆå§‹ç°è‰² */
            transition: background 0.3s;
        }
        .dot-inner.active { background: var(--success-color); animation: pulse 2s infinite; }
        .dot-inner.testing { background: var(--warning-color); animation: pulse 1s infinite; }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(52, 199, 89, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(52, 199, 89, 0); }
            100% { box-shadow: 0 0 0 0 rgba(52, 199, 89, 0); }
        }

        h1 { margin: 0; font-size: 28px; font-weight: 700; letter-spacing: -0.02em; }
        .subtitle { 
            color: var(--text-secondary); 
            font-size: 15px; 
            margin-top: 8px; 
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        /* --- ä¸»å¡ç‰‡ --- */
        .glass-card {
            background: var(--card-bg);
            backdrop-filter: saturate(180%) blur(25px);
            -webkit-backdrop-filter: saturate(180%) blur(25px);
            border: 1px solid var(--card-border);
            border-radius: 32px;
            padding: 36px 28px;
            box-shadow: var(--card-shadow);
            text-align: center;
            animation: fadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) 0.1s backwards;
            transition: height 0.3s ease;
        }

        /* å€’è®¡æ—¶åœ†ç¯ */
        .timer-wrapper {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto 24px;
        }
        
        svg.timer-svg { transform: rotate(-90deg); width: 100%; height: 100%; }
        .timer-circle-bg { fill: none; stroke: rgba(134, 134, 139, 0.15); stroke-width: 6; }
        .timer-circle-fg { 
            fill: none; 
            stroke: url(#gradientStroke); 
            stroke-width: 6; 
            stroke-linecap: round;
            stroke-dasharray: 339.292; /* 2 * PI * 54 */
            stroke-dashoffset: 339.292; 
            transition: stroke-dashoffset 1s linear;
        }
        
        .timer-content {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
        }
        
        .timer-num {
            font-size: 36px; font-weight: 700;
            font-variant-numeric: tabular-nums;
            line-height: 1;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .timer-label { font-size: 12px; color: var(--text-secondary); margin-top: 4px; font-weight: 500; }

        /* çŠ¶æ€æ–‡æœ¬ */
        .status-text { font-size: 16px; color: var(--text-secondary); margin-bottom: 28px; line-height: 1.5; }
        .highlight-node { 
            color: var(--text-primary); 
            font-weight: 600; 
            background: rgba(0, 122, 255, 0.1); 
            padding: 4px 10px; 
            border-radius: 8px;
            display: inline-block;
            margin: 0 4px;
            transition: all 0.3s;
        }
        .highlight-node.error { color: var(--danger-color); background: rgba(255, 59, 48, 0.1); }

        /* æŒ‰é’®ç»„ */
        .btn-group { display: flex; gap: 14px; flex-direction: column; }
        @media (min-width: 360px) { .btn-group { flex-direction: row; } }

        .btn {
            flex: 1;
            height: 52px;
            border-radius: 16px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s cubic-bezier(0.25, 1, 0.5, 1);
            position: relative;
            overflow: hidden;
        }

        .btn:active { transform: scale(0.97); }

        .btn-primary {
            background: var(--accent-gradient);
            color: #fff;
            box-shadow: 0 8px 20px -6px rgba(0, 122, 255, 0.4);
        }
        .btn-primary:hover { box-shadow: 0 12px 24px -8px rgba(0, 122, 255, 0.5); }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.5);
            color: var(--text-primary);
            border: 1px solid var(--card-border);
        }
        @media (prefers-color-scheme: dark) {
            .btn-secondary { background: rgba(255, 255, 255, 0.05); }
        }
        .btn-secondary:hover { background: var(--surface-hover); }

        /* --- åˆ—è¡¨åŒºåŸŸ --- */
        #channel-list {
            margin-top: 24px;
            display: none;
            flex-direction: column;
            gap: 12px;
            text-align: left;
            animation: slideDown 0.4s var(--anim-curve);
        }

        .list-header {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
            padding-left: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .list-item {
            background: var(--card-bg); /* Use card bg for items to blend or stand out */
            background: rgba(255,255,255,0.5);
            backdrop-filter: blur(10px);
            padding: 16px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            border: 1px solid transparent;
            transition: all 0.2s;
            position: relative;
        }
        @media (prefers-color-scheme: dark) {
            .list-item { background: rgba(255, 255, 255, 0.05); }
        }

        .list-item:hover { transform: translateY(-2px); background: var(--card-bg); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .list-item:active { transform: scale(0.98); }
        
        .list-item.is-best { 
            border-color: var(--accent-color); 
            background: rgba(0, 122, 255, 0.03);
        }
        @media (prefers-color-scheme: dark) {
            .list-item.is-best { background: rgba(59, 130, 246, 0.1); }
        }

        .item-left { display: flex; align-items: center; gap: 14px; }
        .item-icon { 
            width: 40px; height: 40px; 
            background: var(--surface-hover); 
            border-radius: 12px; 
            display: flex; align-items: center; justify-content: center; 
            color: var(--text-secondary);
            transition: color 0.3s;
        }
        .is-best .item-icon { color: var(--accent-color); background: rgba(0, 122, 255, 0.1); }

        .item-info h3 { margin: 0; font-size: 16px; font-weight: 600; color: var(--text-primary); }
        .item-info p { margin: 3px 0 0; font-size: 13px; color: var(--text-secondary); }
        
        .item-right { text-align: right; }
        .latency { font-size: 14px; font-weight: 600; font-family: "SF Mono", "Menlo", monospace; letter-spacing: -0.5px; }
        .latency.green { color: var(--success-color); }
        .latency.yellow { color: var(--warning-color); }
        .latency.red { color: var(--danger-color); }

        /* ä¿¡å·ç‚¹ */
        .ping-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 6px; }

        /* --- é¡µè„š --- */
        .footer { 
            margin-top: auto; 
            padding: 10px; 
            text-align: center; 
            font-size: 13px; 
            color: var(--text-secondary);
            animation: fadeIn 1s ease 0.5s backwards;
        }
        .footer-links { display: flex; justify-content: center; gap: 20px; margin-bottom: 12px; }
        .icon-link { 
            color: var(--text-secondary); 
            opacity: 0.7;
            transition: all 0.2s; 
            padding: 8px;
            border-radius: 12px;
        }
        .icon-link:hover { color: var(--text-primary); opacity: 1; background: var(--surface-hover); }

        /* --- SVG Icons --- */
        .icon-svg { width: 20px; height: 20px; fill: currentColor; }

        /* --- åŠ¨ç”»å…³é”®å¸§ --- */
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <!-- èƒŒæ™¯è£…é¥° -->
    <div class="bg-blob"></div>
    <div class="bg-blob two"></div>

    <div class="container">
        <!-- å¤´éƒ¨ -->
        <header class="header">
            <div class="logo-box">
                <img src="https://img.cdn1.vip/i/6921348cd5a96_1763783820.webp" alt="iozz Logo">
                <div class="status-dot"><div class="dot-inner testing" id="main-status-dot"></div></div>
            </div>
            <h1>iozz</h1>
            <p class="subtitle" id="status-line">
                <span id="status-icon">âš¡ï¸</span> 
                <span id="status-text">æ­£åœ¨å¯»æ‰¾æœ€å¿«èŠ‚ç‚¹...</span>
            </p>
        </header>

        <!-- ä¸»æ“ä½œå¡ç‰‡ -->
        <div class="glass-card">
            <div class="timer-wrapper">
                <svg class="timer-svg" viewBox="0 0 120 120">
                    <defs>
                        <linearGradient id="gradientStroke" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:var(--accent-color)" />
                            <stop offset="100%" style="stop-color:#00C6FF" />
                        </linearGradient>
                    </defs>
                    <circle class="timer-circle-bg" cx="60" cy="60" r="54"></circle>
                    <circle id="progress-ring" class="timer-circle-fg" cx="60" cy="60" r="54"></circle>
                </svg>
                <div class="timer-content">
                    <div class="timer-num" id="countdown">5</div>
                    <div class="timer-label">SECONDS</div>
                </div>
            </div>

            <p class="status-text">
                å³å°†è·³è½¬è‡³ <br>
                <span id="best-node" class="highlight-node">æµ‹é€Ÿä¸­...</span>
            </p>

            <div class="btn-group">
                <button id="btn-skip" class="btn btn-primary">
                    <svg class="icon-svg" viewBox="0 0 24 24"><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z" transform="rotate(90 12 12)"/></svg>
                    ç«‹å³è·³è½¬
                </button>
                <button id="btn-manual" class="btn btn-secondary">
                    <svg class="icon-svg" viewBox="0 0 24 24"><path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"/></svg>
                    æ‰‹åŠ¨é€‰æ‹©
                </button>
            </div>

            <!-- åˆ—è¡¨å®¹å™¨ (é»˜è®¤éšè—) -->
            <div id="channel-list"></div>
        </div>

        <!-- é¡µè„š -->
        <footer class="footer">
            <div class="footer-links">
                <a href="#" onclick="toggleEmail(event)" class="icon-link" aria-label="Email">
                    <svg class="icon-svg" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
                </a>
                <a href="https://qm.qq.com/q/LhZz1nJVGa" target="_blank" class="icon-link" aria-label="QQ Group">
                    <svg class="icon-svg" viewBox="0 0 24 24"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm4.24 16L12 15.45 7.77 18l1.12-4.81-3.73-3.23 4.92-.42L12 5l1.92 4.53 4.92.42-3.73 3.23L16.23 18z"/></svg>
                </a>
            </div>
            <p>&copy; 2024 iozz Network. All rights reserved.</p>
        </footer>
    </div>

    <script>
        /**
         * æ ¸å¿ƒé€»è¾‘ (ä¿æŒåŸæœ‰ä¸šåŠ¡é€»è¾‘ä¸å˜ï¼Œå¢å¼ºäº¤äº’åé¦ˆ)
         */
        const CONFIG = {
            autoTime: 5,
            manualTime: 20,
            timeout: 2000,
            email: "admin@kyou.xyz",
            nodes: [
                { id: 'EdgeOne', name: 'EdgeOne', url: 'https://edgeone.iozz.cc/', tag: 'HK Line', w: 90 },
                { id: 'cloudflare', name: 'Cloudflare', url: 'https://cf.iozz.cc/', tag: 'JP Line', w: 90 },
                { id: 'asia', name: 'Asia CDN', url: 'https://cdn.iozz.cc/', tag: 'General', w: 90 },
                { id: 'claw', name: 'Claw Cloud', url: 'https://claw.iozz.cc/', tag: 'Global', w: 90 }
            ]
        };

        // çŠ¶æ€ç®¡ç†
        let state = {
            best: null,
            time: CONFIG.autoTime,
            timer: null,
            listVisible: false,
            tested: false
        };

        const el = {
            time: document.getElementById('countdown'),
            ring: document.getElementById('progress-ring'),
            bestName: document.getElementById('best-node'),
            skipBtn: document.getElementById('btn-skip'),
            manualBtn: document.getElementById('btn-manual'),
            list: document.getElementById('channel-list'),
            statusText: document.getElementById('status-text'),
            statusIcon: document.getElementById('status-icon'),
            mainDot: document.getElementById('main-status-dot')
        };

        async function init() {
            startTimer();
            
            // æ¨¡æ‹Ÿå¹¶å‘æµ‹é€Ÿ
            const promises = CONFIG.nodes.map(node => ping(node));
            await Promise.all(promises);
            
            selectBest();
            renderList();
            state.tested = true;
            el.mainDot.className = 'dot-inner active'; // å˜ç»¿
            el.statusText.textContent = "ä¼˜é€‰çº¿è·¯å·²å°±ç»ª";
            el.statusIcon.textContent = "âœ…";
        }

        function ping(node) {
            const start = Date.now();
            const ctrl = new AbortController();
            const timeoutId = setTimeout(() => ctrl.abort(), CONFIG.timeout);
            const target = `${node.url}${node.url.includes('?') ? '&' : '?'}t=${Date.now()}`;

            return fetch(target, { method: 'HEAD', mode: 'no-cors', signal: ctrl.signal, cache: 'no-store' })
                .then(() => {
                    node.latency = Date.now() - start;
                    node.online = true;
                })
                .catch(() => {
                    node.latency = 9999;
                    node.online = false;
                })
                .finally(() => clearTimeout(timeoutId));
        }

        function selectBest() {
            const onlineNodes = CONFIG.nodes.filter(n => n.online);
            if (onlineNodes.length > 0) {
                onlineNodes.sort((a, b) => a.latency - b.latency);
                state.best = onlineNodes[0];
                updateUI(state.best);
            } else {
                handleAllOffline();
            }
        }

        function updateUI(node) {
            el.bestName.textContent = node.name;
            // ç®€å•çš„æ·¡å…¥æ•ˆæœ
            el.bestName.style.opacity = 0;
            requestAnimationFrame(() => {
                el.bestName.style.transition = 'opacity 0.5s';
                el.bestName.style.opacity = 1;
            });
            // é¢„åŠ è½½
            const link = document.createElement('link');
            link.rel = 'prefetch';
            link.href = node.url;
            document.head.appendChild(link);
        }

        function handleAllOffline() {
            el.bestName.textContent = "æ‰€æœ‰èŠ‚ç‚¹ç¦»çº¿";
            el.bestName.classList.add('error');
            el.skipBtn.disabled = true;
            el.skipBtn.style.opacity = 0.5;
            el.statusText.textContent = "ç½‘ç»œè¿æ¥å¼‚å¸¸";
            el.statusIcon.textContent = "âš ï¸";
            el.mainDot.className = 'dot-inner'; // å˜å›ç°
            stopTimer();
        }

        // --- å€’è®¡æ—¶é€»è¾‘ ---
        function startTimer() {
            if (state.timer) clearInterval(state.timer);
            // 2 * PI * 54 â‰ˆ 339.292
            const totalDash = 339.292; 
            const totalTime = state.listVisible ? CONFIG.manualTime : CONFIG.autoTime;
            state.time = totalTime;

            el.time.textContent = state.time;
            el.ring.style.strokeDashoffset = 0;

            // åˆå§‹åŠ¨ç”»ä¿®æ­£
            el.ring.style.transition = 'none';
            setTimeout(() => {
                 el.ring.style.transition = 'stroke-dashoffset 1s linear';
            }, 10);

            state.timer = setInterval(() => {
                state.time--;
                el.time.textContent = state.time;
                
                const progress = state.time / totalTime;
                el.ring.style.strokeDashoffset = totalDash * (1 - progress);

                if (state.time <= 0) {
                    clearInterval(state.timer);
                    // åªæœ‰åœ¨éæ‰‹åŠ¨æ¨¡å¼æˆ–å·²ç»æµ‹è¯•å®Œæˆçš„æƒ…å†µä¸‹è·³è½¬
                    if (state.best) redirect(state.best);
                }
            }, 1000);
        }

        function stopTimer() {
            clearInterval(state.timer);
            state.timer = null;
            el.time.innerHTML = `<svg viewBox="0 0 24 24" style="width:24px;fill:currentColor"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>`;
            el.ring.style.strokeDashoffset = 339.292; // Empty ring
        }

        function redirect(node) {
            if (!node || !node.url) return;
            el.skipBtn.disabled = true;
            el.skipBtn.innerHTML = `<svg class="icon-svg" style="animation:spin 1s linear infinite" viewBox="0 0 24 24"><path d="M12 4V2C6.48 2 2 6.48 2 12h2c0-4.41 3.59-8 8-8zm0 14c4.41 0 8-3.59 8-8h-2c0 3.31-2.69 6-6 6v2z"/></svg> è·³è½¬ä¸­...`;
            setTimeout(() => window.location.href = node.url, 100);
        }

        // --- äº¤äº’äº‹ä»¶ ---
        el.skipBtn.addEventListener('click', () => {
            stopTimer();
            if(state.best) redirect(state.best);
        });

        el.manualBtn.addEventListener('click', () => {
            state.listVisible = !state.listVisible;
            if (state.listVisible) {
                el.list.style.display = 'flex';
                el.manualBtn.innerHTML = `æ”¶èµ·åˆ—è¡¨`;
                stopTimer(); 
                state.time = CONFIG.manualTime; // Reset for manual selection
                startTimer();
                renderList(); // Ensure list is up to date
                
                // æ»šåŠ¨åˆ°åˆ—è¡¨ä½ç½®
                setTimeout(() => el.list.scrollIntoView({behavior: 'smooth', block: 'start'}), 100);
            } else {
                el.list.style.display = 'none';
                el.manualBtn.innerHTML = `<svg class="icon-svg" viewBox="0 0 24 24"><path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"/></svg> æ‰‹åŠ¨é€‰æ‹©`;
                stopTimer();
                state.time = CONFIG.autoTime;
                startTimer();
            }
        });

        function renderList() {
            if (!state.tested) {
                el.list.innerHTML = '<div style="padding:20px;text-align:center;color:var(--text-secondary)">æ­£åœ¨è·å–èŠ‚ç‚¹æ•°æ®...</div>';
                return;
            }

            const headerHTML = '<div class="list-header">å¯ç”¨èŠ‚ç‚¹åˆ—è¡¨</div>';
            
            const listHTML = CONFIG.nodes.map(n => {
                const isBest = state.best && n.id === state.best.id;
                let latClass = 'green';
                let dotColor = 'var(--success-color)';
                
                if (n.latency > 200) { latClass = 'yellow'; dotColor = 'var(--warning-color)'; }
                if (!n.online || n.latency > 800) { latClass = 'red'; dotColor = 'var(--danger-color)'; }
                
                const latText = n.online ? `${n.latency}ms` : 'Timeout';

                return `
                <div class="list-item ${isBest ? 'is-best' : ''}" onclick="selectNode('${n.id}')">
                    <div class="item-left">
                        <div class="item-icon">
                            ${isBest ? 'ğŸš€' : 'â˜ï¸'}
                        </div>
                        <div class="item-info">
                            <h3>${n.name}</h3>
                            <p>${n.tag}</p>
                        </div>
                    </div>
                    <div class="item-right">
                        <div class="latency ${latClass}">
                            <span class="ping-dot" style="background:${dotColor}"></span>${latText}
                        </div>
                    </div>
                </div>
                `;
            }).join('');
            
            el.list.innerHTML = headerHTML + listHTML;
        }

        window.selectNode = (id) => {
            const node = CONFIG.nodes.find(n => n.id === id);
            if(node) {
                stopTimer();
                redirect(node);
            }
        }

        window.toggleEmail = (e) => {
            e.preventDefault();
            if(el.statusText.innerText.includes('@')) {
                el.statusText.innerText = "æ­£åœ¨å¯»æ‰¾æœ€å¿«èŠ‚ç‚¹...";
            } else {
                el.statusText.innerHTML = `<a href="mailto:${CONFIG.email}" style="color:var(--accent-color);text-decoration:none;font-weight:bold">${CONFIG.email}</a>`;
            }
        }

        // å¯åŠ¨
        init();
    </script>
</body>
</html>
